<?xml version="1.0" encoding="utf-8"?>
<Report xmlns="http://schemas.microsoft.com/sqlserver/reporting/2016/01/reportdefinition" xmlns:rd="http://schemas.microsoft.com/SQLServer/reporting/reportdesigner">
  <AutoRefresh>0</AutoRefresh>
  <DataSources>
    <DataSource Name="DataSource">
      <ConnectionProperties>
        <DataProvider>SQL</DataProvider>
        <ConnectString />
      </ConnectionProperties>
      <rd:SecurityType>None</rd:SecurityType>
      <rd:DataSourceID>eb844e03-339e-4e92-b6b3-f37738fb2ab1</rd:DataSourceID>
    </DataSource>
  </DataSources>
  <ReportSections>
    <ReportSection>
      <Body>
        <Height>9.5525cm</Height>
        <Style />
      </Body>
      <Width>19.95045cm</Width>
      <Page>
        <PageHeader>
          <Height>9.03492cm</Height>
          <PrintOnFirstPage>true</PrintOnFirstPage>
          <PrintOnLastPage>true</PrintOnLastPage>
          <Style>
            <Border>
              <Style>None</Style>
            </Border>
          </Style>
        </PageHeader>
        <PageFooter>
          <Height>2.54cm</Height>
          <PrintOnFirstPage>true</PrintOnFirstPage>
          <PrintOnLastPage>true</PrintOnLastPage>
          <Style>
            <Border>
              <Style>None</Style>
            </Border>
          </Style>
        </PageFooter>
        <PageHeight>29.7cm</PageHeight>
        <PageWidth>20cm</PageWidth>
        <LeftMargin>1cm</LeftMargin>
        <RightMargin>0.1cm</RightMargin>
        <TopMargin>0.1cm</TopMargin>
        <BottomMargin>0.1cm</BottomMargin>
        <ColumnSpacing>1.27cm</ColumnSpacing>
        <Style />
      </Page>
    </ReportSection>
  </ReportSections>
  <Code>Shared LineNbr as Integer
Public PageNum as Integer = 1
Shared VatNbr as Integer
Public OldFactNo as String


Public Function BlankZero(ByVal Value As Decimal)
    if Value = 0 then
        Return ""
    end if
    Return Value
End Function

Public Function BlankPos(ByVal Value As Decimal)
    if Value &gt; 0 then
        Return ""
    end if
    Return Value
End Function

Public Function BlankZeroAndPos(ByVal Value As Decimal)
    if Value &gt;= 0 then
        Return ""
    end if
    Return Value
End Function

Public Function BlankNeg(ByVal Value As Decimal)
    if Value &lt; 0 then
        Return ""
    end if
    Return Value
End Function

Public Function BlankNegAndZero(ByVal Value As Decimal)
    if Value &lt;= 0 then
        Return ""
    end if
    Return Value
End Function

Shared Data1 as Object
Shared Data2 as Object
Shared Data3 as Object
Shared Data4 as Object
Shared Data5 as Object
Shared Data6 as Object
Shared Data7 as Object

Public Function GetData(Num as Integer, Group as integer) as Object
if Group = 1 then
   Return Cstr(Choose(Num, Split(Cstr(Data1),Chr(177))))
End If

if Group = 2 then
   Return Cstr(Choose(Num, Split(Cstr(Data2),Chr(177))))
End If

if Group = 3 then
   Return Cstr(Choose(Num, Split(Cstr(Data3),Chr(177))))
End If

if Group = 4 then
   Return Cstr(Choose(Num, Split(Cstr(Data4),Chr(177))))
End If

if Group = 5 then
   Return Cstr(Choose(Num, Split(Cstr(Data5),Chr(177))))
End If

if Group = 6 then
   Return Cstr(Choose(Num, Split(Cstr(Data6),Chr(177))))
End If

if Group = 7 then
   Return Cstr(Choose(Num, Split(Cstr(Data7),Chr(177))))
End If
End Function

Public Function SetData(NewData as Object,Group as integer)
  If Group = 1 and NewData &gt; "" Then
      Data1 = NewData
  End If

  If Group = 2 and NewData &gt; "" Then
      Data2 = NewData
  End If

  If Group = 3 and NewData &gt; "" Then
      Data3 = NewData
  End If

  If Group = 4 and NewData &gt; "" Then
      Data4 = NewData
  End If

  If Group = 5 and NewData &gt; "" Then
      Data5 = NewData
  End If

  If Group = 6 and NewData &gt; "" Then
      Data6 = NewData
  End If

  If Group = 7 and NewData &gt; "" Then
      Data7 = NewData
  End If
End Function

Public Function IncrLineNbr(Str as String) 
        If Str&lt;&gt;"" Then
                LineNbr=LineNbr+1
        End if
End Function

Public Function GetLineNbr() As Integer
        Return LineNbr/2
End Function    

Public Function SetLineNbr(Nbr as Integer)
        LineNbr=Nbr
End Function
        
Public Function GetEmptyLineNbr () as Integer
        Dim LineNbrT as Integer
        LineNbrT = (LineNbr/2) Mod 22
        If LineNbrT =0 then 
                Return 22
        end if
        Return 12-LineNbrT
End Function

Public Function GetPageNum() as Integer
        Return PageNum
End Function

Public Function SetVatNbr(nbr as integer)
        VatNbr=nbr
end function

Public Function GetVatNbr() as integer
        Return VatNbr
end function

Public Function IncVatNbr()
        VatNbr=VatNbr+1
end function


Shared PictureData1 as Object
Shared PictureData2 as Object
Shared PictureData3 as Object

Public Function GetPicture(Group as integer) as Object
if Group = 1 then
   Return PictureData1
End If

if Group = 2 then
   Return PictureData2
End If

if Group = 3 then
   Return PictureData3
End If
End Function

Public Function SetPicture(NewData as Object,Group as integer)
  If Group = 1 and NewData &gt; "" Then
      PictureData1 = NewData
  End If

  If Group = 2 and NewData &gt; "" Then
      PictureData2 = NewData
  End If

  If Group = 3 and NewData &gt; "" Then
      PictureData3 = NewData
  End If
End Function

REM Reset Page Number:

    Shared offset As Integer
    Shared newPage As Object
    Shared currentgroup1 As Object
    Shared currentgroup2 As Object
    Shared currentgroup3 As Object

    Public Function GetGroupPageNumber(ByVal NewPage As Boolean, ByVal pagenumber As Integer) As Object
        If NewPage Then
            offset = pagenumber - 1
        End If
        Return pagenumber - offset
    End Function

    Public Function IsNewPage(ByVal group1 As Object, ByVal group2 As Object, ByVal group3 As Object) As Boolean
        newPage = False
        If Not (group1 = currentgroup1) Then
            newPage = True
            currentgroup1 = group1
        Else
            If Not (group2 = currentgroup2) Then
                newPage = True
                currentgroup2 = group2
            Else
                If Not (group3 = currentgroup3) Then
                    newPage = True
                    currentgroup3 = group3
                End If
            End If
        End If
        Return newPage
    End Function

</Code>
  <Language>=User!Language</Language>
  <ConsumeContainerWhitespace>true</ConsumeContainerWhitespace>
  <rd:ReportUnitType>Cm</rd:ReportUnitType>
  <rd:ReportID>0eeb6585-38ae-40f1-885b-8d50088d51b4</rd:ReportID>
  <DataSets>
    <DataSet Name="DataSet_Result">
      <Fields>
        <Field Name="Sales_CrMemo_Header_No_">
          <DataField>Sales_CrMemo_Header_No_</DataField>
        </Field>
        <Field Name="CompanyInfo__Logo_ISSA_">
          <DataField>CompanyInfo__Logo_ISSA_</DataField>
        </Field>
        <Field Name="CustAddr_6_">
          <DataField>CustAddr_6_</DataField>
        </Field>
        <Field Name="CustAddr_7_">
          <DataField>CustAddr_7_</DataField>
        </Field>
        <Field Name="CustAddr_5_">
          <DataField>CustAddr_5_</DataField>
        </Field>
        <Field Name="CustAddr_4_">
          <DataField>CustAddr_4_</DataField>
        </Field>
        <Field Name="CustAddr_3_">
          <DataField>CustAddr_3_</DataField>
        </Field>
        <Field Name="CustAddr_2_">
          <DataField>CustAddr_2_</DataField>
        </Field>
        <Field Name="OutputNo">
          <DataField>OutputNo</DataField>
        </Field>
        <Field Name="CustAddr_1_">
          <DataField>CustAddr_1_</DataField>
        </Field>
        <Field Name="InvoiceCaption">
          <DataField>InvoiceCaption</DataField>
        </Field>
        <Field Name="ShipToAddr_6_">
          <DataField>ShipToAddr_6_</DataField>
        </Field>
        <Field Name="ShipToAddr_7_">
          <DataField>ShipToAddr_7_</DataField>
        </Field>
        <Field Name="N__id__intracom_____CompanyInfo__VAT_Registration_No__">
          <DataField>N__id__intracom_____CompanyInfo__VAT_Registration_No__</DataField>
        </Field>
        <Field Name="ShipToAddr_5_">
          <DataField>ShipToAddr_5_</DataField>
        </Field>
        <Field Name="ShipToAddr_4_">
          <DataField>ShipToAddr_4_</DataField>
        </Field>
        <Field Name="ShipToAddr_3_">
          <DataField>ShipToAddr_3_</DataField>
        </Field>
        <Field Name="ShipToAddr_2_">
          <DataField>ShipToAddr_2_</DataField>
        </Field>
        <Field Name="ShipToAddr_1_">
          <DataField>ShipToAddr_1_</DataField>
        </Field>
        <Field Name="Fax_______CompanyInfo__Fax_No__">
          <DataField>Fax_______CompanyInfo__Fax_No__</DataField>
        </Field>
        <Field Name="E_Mail_______CompanyInfo__E_Mail_">
          <DataField>E_Mail_______CompanyInfo__E_Mail_</DataField>
        </Field>
        <Field Name="CompanyAddr_5_">
          <DataField>CompanyAddr_5_</DataField>
        </Field>
        <Field Name="CompanyAddr_3_">
          <DataField>CompanyAddr_3_</DataField>
        </Field>
        <Field Name="CompanyAddr_4_">
          <DataField>CompanyAddr_4_</DataField>
        </Field>
        <Field Name="CompanyAddr_2_">
          <DataField>CompanyAddr_2_</DataField>
        </Field>
        <Field Name="CompanyAddr_1_">
          <DataField>CompanyAddr_1_</DataField>
        </Field>
        <Field Name="Tel_______CompanyInfo__Phone_No__">
          <DataField>Tel_______CompanyInfo__Phone_No__</DataField>
        </Field>
        <Field Name="ShipmentCaption">
          <DataField>ShipmentCaption</DataField>
        </Field>
        <Field Name="CAPTAIN_AND_OWNER_S_OF_M_VCaption">
          <DataField>CAPTAIN_AND_OWNER_S_OF_M_VCaption</DataField>
        </Field>
        <Field Name="au_Capital_de___CompanyInfo__Stock_Capital_">
          <DataField>au_Capital_de___CompanyInfo__Stock_Capital_</DataField>
        </Field>
        <Field Name="CompanyInfo__Logo_AVITA_facture_">
          <DataField>CompanyInfo__Logo_AVITA_facture_</DataField>
        </Field>
        <Field Name="Sales_Cr_Memo_Header___DSA_No__">
          <DataField>Sales_Cr_Memo_Header___DSA_No__</DataField>
        </Field>
        <Field Name="Cust__VAT_Registration_No__">
          <DataField>Cust__VAT_Registration_No__</DataField>
        </Field>
        <Field Name="InvoiceCaption_Control1000000058">
          <DataField>InvoiceCaption_Control1000000058</DataField>
        </Field>
        <Field Name="CustAdditionalname">
          <DataField>CustAdditionalname</DataField>
        </Field>
        <Field Name="CustMail4">
          <DataField>CustMail4</DataField>
        </Field>
        <Field Name="GCO">
          <DataField>GCO</DataField>
        </Field>
        <Field Name="STRSUBSTNO_Text004_CopyText_">
          <DataField>STRSUBSTNO_Text004_CopyText_</DataField>
        </Field>
        <Field Name="Sales_CrMemo_Header__Reference">
          <DataField>Sales_CrMemo_Header__Reference</DataField>
        </Field>
        <Field Name="Sales_Cr_Memo_Line_Description_Caption">
          <DataField>Sales_Cr_Memo_Line_Description_Caption</DataField>
        </Field>
        <Field Name="Sales_Cr_Memo_Line__No__Caption">
          <DataField>Sales_Cr_Memo_Line__No__Caption</DataField>
        </Field>
        <Field Name="Sales_Cr_Memo_Line__VAT_Identifier_Caption">
          <DataField>Sales_Cr_Memo_Line__VAT_Identifier_Caption</DataField>
        </Field>
        <Field Name="AmountCaption">
          <DataField>AmountCaption</DataField>
        </Field>
        <Field Name="Unit_PriceCaption">
          <DataField>Unit_PriceCaption</DataField>
        </Field>
        <Field Name="UnitCaption">
          <DataField>UnitCaption</DataField>
        </Field>
        <Field Name="UnitCaptionFR">
          <DataField>UnitCaptionFR</DataField>
        </Field>
        <Field Name="STRSUBSTNO_Text005_FORMAT_CurrReport_PAGENO__">
          <DataField>STRSUBSTNO_Text005_FORMAT_CurrReport_PAGENO__</DataField>
        </Field>
        <Field Name="ReferenceText">
          <DataField>ReferenceText</DataField>
        </Field>
        <Field Name="Sales_Cr_Memo_Header___Your_Reference_">
          <DataField>Sales_Cr_Memo_Header___Your_Reference_</DataField>
        </Field>
        <Field Name="AmountCaptionFR">
          <DataField>AmountCaptionFR</DataField>
        </Field>
        <Field Name="Unit_PriceCaptionFR">
          <DataField>Unit_PriceCaptionFR</DataField>
        </Field>
        <Field Name="QuantityCaption">
          <DataField>QuantityCaption</DataField>
        </Field>
        <Field Name="QuantityCaptionFR">
          <DataField>QuantityCaptionFR</DataField>
        </Field>
        <Field Name="Sales_Cr_Memo_Line__Line_Amount_">
          <DataField>Sales_Cr_Memo_Line__Line_Amount_</DataField>
        </Field>
        <Field Name="Sales_Cr_Memo_Line__Line_Amount_Format">
          <DataField>Sales_Cr_Memo_Line__Line_Amount_Format</DataField>
        </Field>
        <Field Name="SalesLine__Type_">
          <DataField>SalesLine__Type_</DataField>
        </Field>
        <Field Name="Sales_Cr_Memo_Line_Description">
          <DataField>Sales_Cr_Memo_Line_Description</DataField>
        </Field>
        <Field Name="Sales_Cr_Memo_Line__No__">
          <DataField>Sales_Cr_Memo_Line__No__</DataField>
        </Field>
        <Field Name="Sales_Cr_Memo_Line_Quantity">
          <DataField>Sales_Cr_Memo_Line_Quantity</DataField>
        </Field>
        <Field Name="Sales_Cr_Memo_Line_QuantityFormat">
          <DataField>Sales_Cr_Memo_Line_QuantityFormat</DataField>
        </Field>
        <Field Name="Sales_Cr_Memo_Line__Unit_of_Measure_">
          <DataField>Sales_Cr_Memo_Line__Unit_of_Measure_</DataField>
        </Field>
        <Field Name="Sales_Cr_Memo_Line__Unit_Price_">
          <DataField>Sales_Cr_Memo_Line__Unit_Price_</DataField>
        </Field>
        <Field Name="Sales_Cr_Memo_Line__Unit_Price_Format">
          <DataField>Sales_Cr_Memo_Line__Unit_Price_Format</DataField>
        </Field>
        <Field Name="Sales_Cr_Memo_Line__Line_Amount__Control70">
          <DataField>Sales_Cr_Memo_Line__Line_Amount__Control70</DataField>
        </Field>
        <Field Name="Sales_Cr_Memo_Line__Line_Amount__Control70Format">
          <DataField>Sales_Cr_Memo_Line__Line_Amount__Control70Format</DataField>
        </Field>
        <Field Name="Sales_Cr_Memo_Line__VAT_Identifier_">
          <DataField>Sales_Cr_Memo_Line__VAT_Identifier_</DataField>
        </Field>
        <Field Name="Amount_Including_VAT_">
          <DataField>Amount_Including_VAT_</DataField>
        </Field>
        <Field Name="Amount_Including_VAT_Format">
          <DataField>Amount_Including_VAT_Format</DataField>
        </Field>
        <Field Name="ItemTrans_Description">
          <DataField>ItemTrans_Description</DataField>
        </Field>
        <Field Name="Sales_Cr_Memo_Line__Line_Amount__Control86">
          <DataField>Sales_Cr_Memo_Line__Line_Amount__Control86</DataField>
        </Field>
        <Field Name="Sales_Cr_Memo_Line__Line_Amount__Control86Format">
          <DataField>Sales_Cr_Memo_Line__Line_Amount__Control86Format</DataField>
        </Field>
        <Field Name="InvoiceCaption_Control1000000002">
          <DataField>InvoiceCaption_Control1000000002</DataField>
        </Field>
        <Field Name="Sales_Cr_Memo_Line_Amount">
          <DataField>Sales_Cr_Memo_Line_Amount</DataField>
        </Field>
        <Field Name="Sales_Cr_Memo_Line_AmountFormat">
          <DataField>Sales_Cr_Memo_Line_AmountFormat</DataField>
        </Field>
        <Field Name="Amount_Including_VAT____Amount">
          <DataField>Amount_Including_VAT____Amount</DataField>
        </Field>
        <Field Name="Amount_Including_VAT____AmountFormat">
          <DataField>Amount_Including_VAT____AmountFormat</DataField>
        </Field>
        <Field Name="Sales_Cr_Memo_Line__Amount_Including_VAT_">
          <DataField>Sales_Cr_Memo_Line__Amount_Including_VAT_</DataField>
        </Field>
        <Field Name="Sales_Cr_Memo_Line__Amount_Including_VAT_Format">
          <DataField>Sales_Cr_Memo_Line__Amount_Including_VAT_Format</DataField>
        </Field>
        <Field Name="VATAmountLine_VATAmountText">
          <DataField>VATAmountLine_VATAmountText</DataField>
        </Field>
        <Field Name="TotalExclVATText">
          <DataField>TotalExclVATText</DataField>
        </Field>
        <Field Name="TotalInclVATText">
          <DataField>TotalInclVATText</DataField>
        </Field>
        <Field Name="VatArrayID_1_">
          <DataField>VatArrayID_1_</DataField>
        </Field>
        <Field Name="VatArrayID_2_">
          <DataField>VatArrayID_2_</DataField>
        </Field>
        <Field Name="VatArrayID_3_">
          <DataField>VatArrayID_3_</DataField>
        </Field>
        <Field Name="VatArrayID_4_">
          <DataField>VatArrayID_4_</DataField>
        </Field>
        <Field Name="VatArrayRate_1_">
          <DataField>VatArrayRate_1_</DataField>
        </Field>
        <Field Name="VatArrayRate_1_Format">
          <DataField>VatArrayRate_1_Format</DataField>
        </Field>
        <Field Name="VatArrayRate_2_">
          <DataField>VatArrayRate_2_</DataField>
        </Field>
        <Field Name="VatArrayRate_2_Format">
          <DataField>VatArrayRate_2_Format</DataField>
        </Field>
        <Field Name="VatArrayRate_3_">
          <DataField>VatArrayRate_3_</DataField>
        </Field>
        <Field Name="VatArrayRate_3_Format">
          <DataField>VatArrayRate_3_Format</DataField>
        </Field>
        <Field Name="VatArrayRate_4_">
          <DataField>VatArrayRate_4_</DataField>
        </Field>
        <Field Name="VatArrayRate_4_Format">
          <DataField>VatArrayRate_4_Format</DataField>
        </Field>
        <Field Name="VatArrayBase_1_">
          <DataField>VatArrayBase_1_</DataField>
        </Field>
        <Field Name="VatArrayBase_1_Format">
          <DataField>VatArrayBase_1_Format</DataField>
        </Field>
        <Field Name="VatArrayBase_2_">
          <DataField>VatArrayBase_2_</DataField>
        </Field>
        <Field Name="VatArrayBase_2_Format">
          <DataField>VatArrayBase_2_Format</DataField>
        </Field>
        <Field Name="VatArrayBase_3_">
          <DataField>VatArrayBase_3_</DataField>
        </Field>
        <Field Name="VatArrayBase_3_Format">
          <DataField>VatArrayBase_3_Format</DataField>
        </Field>
        <Field Name="VatArrayBase_4_">
          <DataField>VatArrayBase_4_</DataField>
        </Field>
        <Field Name="VatArrayBase_4_Format">
          <DataField>VatArrayBase_4_Format</DataField>
        </Field>
        <Field Name="VatArrayAmount_1_">
          <DataField>VatArrayAmount_1_</DataField>
        </Field>
        <Field Name="VatArrayAmount_1_Format">
          <DataField>VatArrayAmount_1_Format</DataField>
        </Field>
        <Field Name="VatArrayAmount_2_">
          <DataField>VatArrayAmount_2_</DataField>
        </Field>
        <Field Name="VatArrayAmount_2_Format">
          <DataField>VatArrayAmount_2_Format</DataField>
        </Field>
        <Field Name="VatArrayAmount_3_">
          <DataField>VatArrayAmount_3_</DataField>
        </Field>
        <Field Name="VatArrayAmount_3_Format">
          <DataField>VatArrayAmount_3_Format</DataField>
        </Field>
        <Field Name="VatArrayAmount_4_">
          <DataField>VatArrayAmount_4_</DataField>
        </Field>
        <Field Name="VatArrayAmount_4_Format">
          <DataField>VatArrayAmount_4_Format</DataField>
        </Field>
        <Field Name="PaymentMethod_Description__________PaymentTerms_Description">
          <DataField>PaymentMethod_Description__________PaymentTerms_Description</DataField>
        </Field>
        <Field Name="Conditions_de_paiement___Settlement___Caption">
          <DataField>Conditions_de_paiement___Settlement___Caption</DataField>
        </Field>
        <Field Name="TauxCaption">
          <DataField>TauxCaption</DataField>
        </Field>
        <Field Name="BaseCaption">
          <DataField>BaseCaption</DataField>
        </Field>
        <Field Name="MontantCaption">
          <DataField>MontantCaption</DataField>
        </Field>
        <Field Name="LA_MARCHANDISE_LIVREE_RESTECaption">
          <DataField>LA_MARCHANDISE_LIVREE_RESTECaption</DataField>
        </Field>
        <Field Name="Sales_CrMemo_Line_Document_No_">
          <DataField>Sales_CrMemo_Line_Document_No_</DataField>
        </Field>
        <Field Name="Sales_CrMemo_Line_Line_No_">
          <DataField>Sales_CrMemo_Line_Line_No_</DataField>
        </Field>
      </Fields>
      <Query>
        <DataSourceName>DataSource</DataSourceName>
        <CommandText />
      </Query>
    </DataSet>
  </DataSets>
</Report>